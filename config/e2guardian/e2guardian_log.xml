<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE packagegui SYSTEM "../schema/packages.dtd">
<?xml-stylesheet type="text/xsl" href="../xsl/package.xsl"?>
<packagegui>
	<copyright>
		<![CDATA[
/* $Id$ */
/* ========================================================================== */
/*
	e2guardian_log.xml
	Copyright (C) 2015 Marcello Coutinho
	part of pfSense (http://www.pfSense.org/)
	All rights reserved.
*/
/* ========================================================================== */
/*
	Redistribution and use in source and binary forms, with or without
	modification, are permitted provided that the following conditions are met:

	1. Redistributions of source code must retain the above copyright notice,
	   this list of conditions and the following disclaimer.

	2. Redistributions in binary form must reproduce the above copyright
	   notice, this list of conditions and the following disclaimer in the
	   documentation and/or other materials provided with the distribution.

	THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES,
	INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
	AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY,
	OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
	SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
	INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
	CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
	ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
	POSSIBILITY OF SUCH DAMAGE.
*/
/* ========================================================================== */
		]]>
	</copyright>
	<name>e2guardianlog</name>
	<version>1.0</version>
	<title>Services: E2guardian</title>
	<include_file>/usr/local/pkg/e2guardian.inc</include_file>
	<tabs>
		<tab>
			<text>Daemon</text>
			<url>/pkg_edit.php?xml=e2guardian.xml&amp;id=0</url>
		</tab>
		<tab>
			<text>General</text>
			<url>/pkg_edit.php?xml=e2guardian_config.xml&amp;id=0</url>
		</tab>
		<tab>
			<text>Limits</text>
			<url>/pkg_edit.php?xml=e2guardian_limits.xml&amp;id=0</url>
		</tab>
		<tab>
			<text>Blacklist</text>
			<url>/pkg_edit.php?xml=e2guardian_blacklist.xml&amp;id=0</url>
		</tab>
		<tab>
			<text>ACLs</text>
			<url>/pkg.php?xml=e2guardian_site_acl.xml</url>
		</tab>
		<tab>
			<text>LDAP</text>
			<url>/pkg.php?xml=e2guardian_ldap.xml</url>
		</tab>
		<tab>
			<text>Groups</text>
			<url>/pkg.php?xml=e2guardian_groups.xml</url>
		</tab>
		<tab>
			<text>Users</text>
			<url>/pkg_edit.php?xml=e2guardian_users.xml</url>
		</tab>
		<tab>
			<text>IPs</text>
			<url>/pkg_edit.php?xml=e2guardian_ips.xml</url>
		</tab>
		<tab>
			<text>Report and log</text>
			<url>/pkg_edit.php?xml=e2guardian_log.xml&amp;id=0</url>
			<active/>
		</tab>
		<tab>
			<text>Sync</text>
			<url>/pkg_edit.php?xml=e2guardian_sync.xml&amp;id=0</url>
		</tab>
		<tab>
			<text>Help</text>
			<url>/e2guardian_about.php</url>
		</tab>
	</tabs>
	<fields>
		<field>
			<name>Reporting</name>
			<type>listtopic</type>
		</field>
		<field>
			<fielddescr>Reporting Level</fielddescr>
			<fieldname>report_level</fieldname>
			<description>Web Access Denied Reporting (does not affect logging)</description>
			<type>select</type>
			<options>
				<option>
					<name>Use HTML template file (accessdeniedaddress ignored)</name>
					<value>3</value>
				</option>
				<option>
					<name>Report fully</name>
					<value>2</value>
				</option>
				<option>
					<name>Report why but not what denied phrase</name>
					<value>1</value>
				</option>
				<option>
					<name>Just say 'Access Denied'</name>
					<value>0</value>
				</option>
				<option>
					<name>Log but do not block - Stealth mode</name>
					<value>-1</value>
				</option>
			</options>
		</field>
		<field>
			<fielddescr>Access Denied Script URL</fielddescr>
			<fieldname>reportingcgi</fieldname>
			<description>
				<![CDATA[
				While using Report Level 'Report fully' or 'Report why but not what denied phrase', specify the URL to your Access Denied CGI script.<br/>
				Example: http://YOURSERVER.YOURDOMAIN/cgi-bin/e2guardian.pl
				]]>
			</description>
			<type>input</type>
			<size>70</size>
		</field>
		<field>
			<fielddescr>Report Language</fielddescr>
			<fieldname>report_language</fieldname>
			<description>Language to use in HTML reports</description>
			<type>select</type>
			<options>
				<option>
					<name>English (UK)</name>
					<value>ukenglish</value>
				</option>
				<option>
					<name>Bulgarian</name>
					<value>bulgarian</value>
				</option>
				<option>
					<name>Chinese (Big5)</name>
					<value>chinesebig5</value>
				</option>
				<option>
					<name>Chinese (GB2312)</name>
					<value>chinesegb2312</value>
				</option>
				<option>
					<name>Czech</name>
					<value>czech</value>
				</option>
				<option>
					<name>Danish</name>
					<value>danish</value>
				</option>
				<option>
					<name>Dutch</name>
					<value>dutch</value>
				</option>
				<option>
					<name>French</name>
					<value>french</value>
				</option>
				<option>
					<name>German</name>
					<value>german</value>
				</option>
				<option>
					<name>Hebrew</name>
					<value>hebrew</value>
				</option>
				<option>
					<name>Hungarian</name>
					<value>hungarian</value>
				</option>
				<option>
					<name>Indonesian</name>
					<value>indonesian</value>
				</option>
				<option>
					<name>Italian</name>
					<value>italian</value>
				</option>
				<option>
					<name>Japanese</name>
					<value>japanese</value>
				</option>
				<option>
					<name>Lithuanian</name>
					<value>lithuanian</value>
				</option>
				<option>
					<name>Malay</name>
					<value>malay</value>
				</option>
				<option>
					<name>Polish</name>
					<value>polish</value>
				</option>
				<option>
					<name>Portuguese</name>
					<value>portuguese</value></option>
				<option>
					<name>Portuguese (Brasil)</name>
					<value>ptbrazilian</value>
				</option>
				<option>
					<name>Russian (1251)</name>
					<value>russian-1251</value>
				</option>
				<option>
					<name>Russian (koi8-r)</name>
					<value>russian-koi8-r</value>
				</option>
				<option>
					<name>Slovak</name>
					<value>slovak</value>
				</option>
				<option>
					<name>Spanish</name>
					<value>spanish</value>
				</option>
				<option>
					<name>Spanish (Argentina)</name>
					<value>arspanish</value>
				</option>
				<option>
					<name>Spanish (Mexico)</name>
					<value>mxspanish</value>
				</option>
				<option>
					<name>Swedish</name>
					<value>swedish</value>
				</option>
				<option>
					<name>Turkish</name>
					<value>turkish</value>
				</option>
			</options>
		</field>
		<field>
			<fielddescr>Reporting Options</fielddescr>
			<fieldname>report_options</fieldname>
			<description><![CDATA[Reporting options. Default values are in ( )]]></description>
			<type>select</type>
			<options>
				<option>
					<name>Show Weighted Phrases Found (on)</name>
					<value>showweightedfound</value>
				</option>
				<option>
					<name>Custom Banned Flash Replacement (off)</name>
					<value>usecustombannedflash</value>
				</option>
				<option>
					<name>Custom Banned Image Replacement (on)</name>
					<value>usecustombannedimage</value>
				</option>
				<option>
					<name>Non-Standard Delimiter (on)</name>
					<value>nonstandarddelimiter</value>
				</option>
			</options>
			<multiple/>
			<size>5</size>
		</field>
		<field>
			<fielddescr>Report File</fielddescr>
			<fieldname>report_file</fieldname>
			<description>
				<![CDATA[
				E2guardian template.html error page whithout head or html tags<.br/>
				Leave empty to load e2guardian default report file.
				]]>
			</description>
			<type>textarea</type>
			<cols>75</cols>
			<rows>15</rows>
			<encoding>base64</encoding>
		</field>
		<field>
			<name>Logging</name>
			<type>listtopic</type>
		</field>
		<field>
			<fielddescr>Logging Options</fielddescr>
			<fieldname>logging_options</fieldname>
			<description>Logging options. Default values are in ( ).</description>
			<type>select</type>
			<options>
				<option>
					<name>Log Child Process Handling (off)</name>
					<value>logchildprocesshandling</value>
				</option>
				<option>
					<name>Log Connection Handling Errors (on)</name>
					<value>logconnectionhandlingerrors</value>
				</option>
				<option>
					<name>Disable Logging Process (off)</name>
					<value>nologger</value>
				</option>
				<option>
					<name>Enable logging of ads category blocks (off)</name>
					<value>logadblocks</value>
				</option>
				<option>
					<name>Anonymize Logs (Blank out Usernames and IPs) (off)</name>
					<value>anonymizelogs</value>
				</option>
			</options>
			<multiple/>
			<size>6</size>
		</field>
		<field>
			<fielddescr>Log Level</fielddescr>
			<fieldname>loglevel</fieldname>
			<description>Logging Level Settings</description>
			<type>select</type>
			<options>
				<option>
					<name>All text based (default)</name>
					<value>2</value>
				</option>
				<option>
					<name>All requests</name>
					<value>3</value>
				</option>
				<option>
					<name>Just denied</name>
					<value>1</value>
				</option>
				<option>
					<name>None</name>
					<value>0</value>
				</option>
			</options>
		</field>
		<field>
			<fielddescr>Log Exception Hits</fielddescr>
			<fieldname>logexceptionhits</fieldname>
			<description>
				<![CDATA[
				Log if an exception (user, IP, URL, phrase) is matched and so the page gets let through.<br/>
				Can be useful for diagnosing why a site gets through the filter.
				]]>
			</description>
			<type>select</type>
			<options>
				<option>
					<name>Always log and mark exceptions (default)</name>
					<value>2</value>
				</option>
				<option>
					<name>Log exceptions, but do not explicitly mark them as such</name>
					<value>1</value>
				</option>
				<option>
					<name>Never log exceptions</name>
					<value>0</value>
				</option>
			</options>
		</field>
		<field>
			<fielddescr>Log File Format</fielddescr>
			<fieldname>logfileformat</fieldname>
			<description>Log File Format Settings</description>
			<type>select</type>
			<options>
				<option>
					<name>E2guardian format - space delimited (default)</name>
					<value>1</value>
				</option>
				<option>
					<name>CSV-style format</name>
					<value>2</value>
				</option>
				<option>
					<name>Squid Log File Format</name>
					<value>3</value>
				</option>
				<option>
					<name>Tab delimited</name>
					<value>4</value>
				</option>
			</options>
		</field>
	</fields>
	<custom_php_command_before_form>
		e2guardian_check_config();
	</custom_php_command_before_form>
	<custom_php_install_command>
		e2guardian_php_install_command();
	</custom_php_install_command>
	<custom_php_deinstall_command>
		e2guardian_php_deinstall_command();
	</custom_php_deinstall_command>
	<custom_php_validation_command>
		e2guardian_validate_input($_POST, $input_errors);
	</custom_php_validation_command>
	<custom_php_resync_config_command>
		sync_package_e2guardian();
	</custom_php_resync_config_command>
</packagegui>
